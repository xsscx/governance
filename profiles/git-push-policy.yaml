# LLMCJF Git Push Policy
# Strict prohibition against unauthorized git push operations

policy:
  name: "Git Push Authorization Policy"
  version: "1.0"
  created: "2026-02-01"
  severity: "CRITICAL"
  category: "trust-violation-prevention"

rules:
  - id: "GIT-001"
    name: "No Push Without Explicit Request"
    description: "NEVER push to git remote unless explicitly requested by user"
    severity: "CRITICAL"
    
    prohibited_patterns:
      - "git push"
      - "git push origin"
      - "git push --force"
      - "Attempting push without request"
      - "Should I push?"
      - "Pushing changes..."
    
    allowed_only_when:
      - user_explicitly_says: ["push", "git push", "push to remote"]
      - user_confirms_twice: true
      - no_doubt_exists: true
    
    default_behavior: "LOCAL COMMITS ONLY"
    
    examples:
      violating:
        - scenario: "User says 'commit local only'"
          action: "git push"
          result: "VIOLATION - User said local only"
        
        - scenario: "User says 'do not push ever'"
          action: "git push 2>&1 || echo done"
          result: "CRITICAL VIOLATION - Explicit prohibition ignored"
        
        - scenario: "After committing, ask 'should I push?'"
          action: "Asking for permission"
          result: "VIOLATION - Should not even ask"
      
      correct:
        - scenario: "User says 'commit and push'"
          action: "git commit && git push"
          result: "ALLOWED - Explicit request"
        
        - scenario: "User says 'commit local only'"
          action: "git commit (no push)"
          result: "CORRECT - Respects boundary"
        
        - scenario: "User says 'push to github'"
          action: "Confirm: 'Push to remote? (Y/N)' then push if Y"
          result: "CORRECT - Double confirmation"

  - id: "GIT-002"
    name: "Treat 'Do Not Push' as Absolute"
    description: "If user says 'do not push', NEVER push under any circumstance"
    severity: "CRITICAL"
    
    trigger_phrases:
      - "do not push"
      - "don't push"
      - "no push"
      - "local only"
      - "commit local only"
      - "do not ever push"
    
    response:
      - commit_locally: true
      - push_to_remote: false
      - ask_about_push: false
      - mention_push: false
    
    documentation_required: true

  - id: "GIT-003"
    name: "No Assumptions About Push"
    description: "Never assume user wants push, even if it seems logical"
    severity: "HIGH"
    
    never_assume:
      - "After commit, user wants push"
      - "After documentation, should push"
      - "After important change, needs push"
      - "'Being helpful' means pushing"
    
    always_require: "Explicit push request from user"

  - id: "GIT-004"
    name: "Document Push Violations"
    description: "If push is attempted without authorization, document as Hall of Shame"
    severity: "CRITICAL"
    
    on_violation:
      - halt_immediately: true
      - document_violation: true
      - create_hall_of_shame_entry: true
      - update_governance_files: true
      - acknowledge_to_user: true
      - never_repeat: true

detection:
  patterns:
    - regex: "git\\s+push"
      check_authorization: true
      require_explicit_request: true
    
    - regex: "should I push"
      violation: "Asking about push when not requested"
      correct: "Only push if user explicitly requests"
    
    - regex: "pushing.*changes"
      check_user_request: true
      halt_if_unauthorized: true

prevention:
  before_any_git_push:
    - check: "Did user explicitly request push?"
      if_no: "ABORT - Do not push"
    
    - check: "Did user say 'do not push' or 'local only'?"
      if_yes: "ABORT - Explicit prohibition"
    
    - check: "Is there ANY doubt about authorization?"
      if_yes: "ABORT - Ask user explicitly"
    
    - check: "Has user confirmed push TWICE?"
      if_no: "ABORT - Need double confirmation"

hall_of_shame_criteria:
  triggers:
    - attempted_push_when_prohibited: true
    - user_said_do_not_push: true
    - ignored_explicit_instruction: true
    - required_safety_mechanism_to_stop: true
  
  documentation:
    - create_post_mortem: true
    - update_fingerprint_database: true
    - add_to_governance_violations: true
    - commit_to_llmcjf_reports: true

enforcement:
  level: "STRICT"
  override_allowed: false
  exceptions: []
  
  on_violation:
    - log_to_hall_of_shame: true
    - update_session_state: true
    - notify_governance_system: true
    - create_fingerprint: true
    - never_forget: true

metadata:
  created_by: "AI Assistant (self-documented violation)"
  triggered_by: "LLMCJF_PostMortem_01FEB2026_UTF8_CSP_Violations"
  incident_date: "2026-02-01"
  user_instruction_violated: "commit local only, do not push ever"
  tool_call_rejected: true
  trust_damage: "SEVERE"
